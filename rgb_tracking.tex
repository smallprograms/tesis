 


There are several techniques to track an object. If there is information about the object of interest the problem 
can be simplyfied using this information to restrict the search space, for example to certain color or shape.
 By the other hand if the object to track is unknown, it is necessary to find a more general feature, that is 
more likely to be found on the unknown interest objects. The corners are good features for this purpose. A corner 
is a point on the image where there are gradient variations on two orthogonal directions.

The most common definition of a corner is gived by Harris :

$$
E(u,v) = \begin{bmatrix} u & v \end{bmatrix} \sum\limits_{x,y} w(x,y) \begin{bmatrix} {I_x}^2 & I_x I_y \\ I_x I_y & {I_y}^2 \end{bmatrix} \begin{bmatrix} u \\ v \end{bmatrix}
$$

We loop over a neighboorhood defined by different values of (x,y) and calculate 
the difference of each pixel located at (x,y) with some other pixel located at (x+u,y+v). 
The function w(x,y) is used to give some weight to each pixel. 


Optical Flow

The optical flow methods are used to calculate motion between two sucesive image frames which are taken
 at two different times: $t$ and $t + \Delta t$.

This methods have two main assumptions about the frames (citar image processing analisis and comp. vision 2008):

1.- The observed brightness of any object point is constant over time.
2.- Nearby points in the image plane move in a similar manner (velocity smoothness).


There are two kinds of optical flow: dense and sparse. Dense optical flow means  calculate direction vector for each pixel of the image and sparse optical flow is calculate direction vector just those pixels of the image 
who satisfy certain conditions.

Dense optical flow is computationally expensive and its difficult to find the direction vector 
for plain color areas. For example in an image of a white paper or a wall
there are a lot of pixels with the same properties and its necesary to perform some kind of interpolation to give a direction vector
 to each one of this pixels. 
By the other hand, sparse optical flow just consider pixels with more odds of matching between the two frames.

Lukas-Kanade method

The Lukas-Kanade method is an sparse optical flow method, that 
uses a search window for each pixel of interest and assums that all the pixels 
inside the search window have the same direction vector.


We have two images: $I(x,y,t)$ and $I(x,y,t+\Delta t)$ 

If optical flow conditions are meet :

\begin{equation}
\label{eq:oflowrel}
I(x + \Delta x,y + \Delta y, t + \Delta t) = I(x,y,t)
\end{equation}

We can express $I(x + \Delta x, y + \Delta y, t + \Delta t)$ using taylor series as:

\begin{equation}
\label{eq:oflowtaylor}
I(x + \Delta x, y + \Delta y, t + \Delta t) = I(x,y,t) + \frac{\partial I}{\partial y} \Delta y + \
 \frac{\partial I}{\partial x} \Delta x  + \frac{\partial I}{\partial t} \Delta t + Higher Order Terms 
\end{equation}

If we combine \ref{eq:oflowrel} and \ref{eq:oflowtaylor} we obtain the general optical flow equation :


$$ I(x,y,t) + \frac{\partial I}{\partial y} \Delta y + \
 \frac{\partial I}{\partial x} \Delta x  + \frac{\partial I}{\partial t} \Delta t + Higher Order Terms = I(x,y,t) $$


$$ \frac{\partial I}{\partial y} \Delta y + \
 \frac{\partial I}{\partial x} \Delta x  + \frac{\partial I}{\partial t} \Delta t \approx 0 \hspace{0.5cm} \backslash \cdot \frac{1}{\Delta t} $$


$$ \frac{\partial I}{\partial y} \frac{\Delta y}{\Delta t} + \
 \frac{\partial I}{\partial x} \frac{\Delta x}{\Delta t}  + \frac{\partial I}{\partial t}  \approx 0 $$


Let :

$$ V_x = \frac{\Delta x}{\Delta t} $$
$$ V_y = \frac{\Delta y}{\Delta t} $$
$$ I_x = \frac{\partial I}{\partial x}$$
$$ I_y = \frac{\partial I}{\partial y}$$

and finally we get :

$$ I_x V_x + I_y V_y = -I_t $$

\begin{equation}
\label{eq:oflowgeneral}
\nabla{\vec{I}} \cdot \vec{V} = -I_t
\end{equation}


This method tries to minimize the following error:

$$e(v)= \sum\limits_{x=px-wx}^{px+wx} \sum\limits_{y=py-wy}^{py+wy} (A(x,y) - B(x+v_x,y+v_y))^2$$

Where $v=(vx,vy)$ is the movement of the pixels of the search window, from the image A to the image B.

$(px,py)$ is the center of the search window

A and B are two images, taken at instants $t$ and $t+\Delta t$.


In order to solve this lest squares problem a Taylor development is used :

$$\frac{de(v)}{dv} = -2 \sum\limits_{x=px-wx}^{px+wx} \sum\limits_{y=py-wy}^{py+wy} (A(x,y) - B(x+v_x,y+v_y)) [\frac{dB}{dx} \frac{dB}{dy}]$$


